{
  "hash": "d25f2fb055c2aa2e3aaf4bc792342fb3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Citation Network Visualization\"\n---\n\n## Overview\n\nThe `create_citation_network()` function creates interactive visualizations showing how citations co-occur within documents. Citations appearing close together are connected, revealing patterns in how references are used and cited together.\n\n## Main Function\n\n### create_citation_network()\n\nCreate an interactive citation co-occurrence network.\n\n**Usage**\n\n```r\ncreate_citation_network(\n  citation_analysis_results,\n  max_distance = 800,\n  min_connections = 2,\n  show_labels = TRUE\n)\n```\n\n**Arguments**\n\n- `citation_analysis_results`: Output from `analyze_scientific_content()`\n- `max_distance`: Maximum distance in characters between citations to create a connection\n- `min_connections`: Minimum number of connections required to include a node\n- `show_labels`: Logical. Whether to display citation labels on nodes\n\n**Value**\n\nAn interactive `visNetwork` object with attributes:\n\n- `stats`: Network statistics including node count, edge count, distances, and section distribution\n\n## Basic Usage\n\n### Creating a Network\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(contentanalysis)\nlibrary(dplyr)\n\n# First, analyze the document\ndoc <- pdf2txt_auto(\"paper.pdf\", n_columns = 2)\nanalysis <- analyze_scientific_content(\n  text = doc,\n  doi = \"10.xxxx/xxxxx\",\n  mailto = \"your@email.com\"\n)\n\n# Create network with default settings\nnetwork <- create_citation_network(\n  citation_analysis_results = analysis,\n  max_distance = 800,\n  min_connections = 2,\n  show_labels = TRUE\n)\n\n# Display the network\nnetwork\n```\n:::\n\n\n### Network Statistics\n\nAccess detailed network statistics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get statistics\nstats <- attr(network, \"stats\")\n\n# Basic network info\ncat(\"Number of nodes:\", stats$n_nodes, \"\\n\")\ncat(\"Number of edges:\", stats$n_edges, \"\\n\")\ncat(\"Average distance:\", round(stats$avg_distance), \"characters\\n\")\ncat(\"Maximum distance:\", stats$max_distance, \"characters\\n\")\n\n# Section distribution\nprint(stats$section_distribution)\n\n# Multi-section citations\nif (nrow(stats$multi_section_citations) > 0) {\n  cat(\"\\nCitations appearing in multiple sections:\\n\")\n  print(stats$multi_section_citations)\n}\n```\n:::\n\n\n## Visual Elements\n\n### Node Features\n\n**Size**\n- Larger nodes have more connections\n- Size represents centrality in the citation network\n\n**Color**\n- Indicates primary section where citation appears\n- Default color scheme:\n  - Introduction: Light blue\n  - Methods: Light green\n  - Results: Light coral\n  - Discussion: Light yellow\n  - Abstract: Lavender\n\n**Border**\n- Thicker borders (3px): Citations in multiple sections\n- Standard borders (1px): Citations in single section\n\n### Edge Features\n\n**Thickness**\n- Thicker edges: Citations appearing closer together\n- Edge width inversely proportional to distance\n\n**Color**\n- Red: Very close citations (≤300 characters)\n- Blue: Moderate distance (≤600 characters)\n- Gray: Distant citations (>600 characters)\n\n## Customization\n\n### Adjusting Distance Threshold\n\nControl which citations are connected:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Very close citations only\nnetwork_close <- create_citation_network(\n  analysis,\n  max_distance = 300,  # Within 300 characters\n  min_connections = 1,\n  show_labels = TRUE\n)\n\n# Moderate proximity\nnetwork_medium <- create_citation_network(\n  analysis,\n  max_distance = 600,\n  min_connections = 2,\n  show_labels = TRUE\n)\n\n# Broad connections\nnetwork_broad <- create_citation_network(\n  analysis,\n  max_distance = 1200,\n  min_connections = 2,\n  show_labels = TRUE\n)\n\n# Compare network sizes\ncat(\"Close:\", attr(network_close, \"stats\")$n_edges, \"edges\\n\")\ncat(\"Medium:\", attr(network_medium, \"stats\")$n_edges, \"edges\\n\")\ncat(\"Broad:\", attr(network_broad, \"stats\")$n_edges, \"edges\\n\")\n```\n:::\n\n\n### Filtering by Connections\n\nFocus on well-connected citations:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Include all connected citations\nnetwork_all <- create_citation_network(\n  analysis,\n  max_distance = 800,\n  min_connections = 1\n)\n\n# Only \"hub\" citations (highly connected)\nnetwork_hubs <- create_citation_network(\n  analysis,\n  max_distance = 800,\n  min_connections = 5,  # Must have 5+ connections\n  show_labels = TRUE\n)\n\n# Compare\ncat(\"All nodes:\", attr(network_all, \"stats\")$n_nodes, \"\\n\")\ncat(\"Hub nodes:\", attr(network_hubs, \"stats\")$n_nodes, \"\\n\")\n```\n:::\n\n\n### Label Display\n\nControl label visibility:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# With labels (default for detailed inspection)\nnetwork_labeled <- create_citation_network(\n  analysis,\n  show_labels = TRUE\n)\n\n# Without labels (cleaner for presentations)\nnetwork_clean <- create_citation_network(\n  analysis,\n  show_labels = FALSE\n)\n```\n:::\n\n\n## Interpreting Networks\n\n### Identifying Patterns\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get network statistics\nstats <- attr(network, \"stats\")\n\n# 1. Network density (how interconnected)\nn_possible_edges <- stats$n_nodes * (stats$n_nodes - 1) / 2\ndensity <- stats$n_edges / n_possible_edges\ncat(\"Network density:\", round(density, 3), \"\\n\")\n\n# 2. Find hub citations (top 25% by connections)\nhub_threshold <- quantile(stats$section_distribution$n, 0.75)\nhubs <- stats$section_distribution %>%\n  filter(n >= hub_threshold) %>%\n  arrange(desc(n))\n\ncat(\"\\nHub citations:\\n\")\nprint(hubs)\n\n# 3. Section-specific patterns\nsection_summary <- stats$section_distribution %>%\n  group_by(section) %>%\n  summarise(\n    n_citations = n(),\n    avg_connections = mean(n),\n    .groups = \"drop\"\n  )\n\nprint(section_summary)\n```\n:::\n\n\n### Citation Clusters\n\nIdentify groups of related citations:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Citations with very close connections\nclose_pairs <- analysis$network_data %>%\n  filter(distance < 200) %>%\n  select(citation_from, citation_to, distance)\n\ncat(\"Very close citation pairs:\", nrow(close_pairs), \"\\n\")\nhead(close_pairs)\n\n# Find citation communities (simple approach)\n# Citations that frequently co-occur\ncitation_freq <- analysis$network_data %>%\n  count(citation_from, sort = TRUE)\n\ntop_cooccurring <- head(citation_freq, 10)\ncat(\"\\nMost frequently co-occurring citations:\\n\")\nprint(top_cooccurring)\n```\n:::\n\n\n### Cross-Section Analysis\n\nCitations appearing in multiple sections:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstats <- attr(network, \"stats\")\n\nif (nrow(stats$multi_section_citations) > 0) {\n  # Citations used across sections\n  multi_section <- stats$multi_section_citations %>%\n    arrange(desc(n_sections))\n  \n  cat(\"Citations in multiple sections:\\n\")\n  print(multi_section)\n  \n  # These are often seminal or foundational works\n  cat(\"\\nThese citations appear in\", \n      unique(multi_section$n_sections), \n      \"different sections\\n\")\n}\n```\n:::\n\n\n## Advanced Analysis\n\n### Compare Networks Across Papers\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Analyze multiple papers\npapers <- c(\"paper1.pdf\", \"paper2.pdf\", \"paper3.pdf\")\n\nnetworks <- list()\nfor (i in seq_along(papers)) {\n  doc <- pdf2txt_auto(papers[i], n_columns = 2)\n  analysis <- analyze_scientific_content(\n    doc,\n    doi = paste0(\"10.xxxx/\", i),\n    mailto = \"your@email.com\"\n  )\n  networks[[i]] <- create_citation_network(analysis)\n}\n\n# Compare network characteristics\ncomparison <- data.frame(\n  paper = papers,\n  nodes = sapply(networks, function(n) attr(n, \"stats\")$n_nodes),\n  edges = sapply(networks, function(n) attr(n, \"stats\")$n_edges),\n  avg_distance = sapply(networks, function(n) \n    round(attr(n, \"stats\")$avg_distance))\n)\n\nprint(comparison)\n\n# Calculate network densities\ncomparison$density <- comparison$edges / \n  (comparison$nodes * (comparison$nodes - 1) / 2)\n\nprint(comparison)\n```\n:::\n\n\n### Network Metrics\n\nCalculate advanced network metrics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(igraph)\n\n# Convert to igraph object (if needed for advanced analysis)\n# Note: You'll need the raw network data\nedges <- analysis$network_data %>%\n  filter(distance <= 800) %>%\n  select(from = citation_from, to = citation_to, weight = distance)\n\ng <- graph_from_data_frame(edges, directed = FALSE)\n\n# Calculate metrics\nmetrics <- data.frame(\n  citation = V(g)$name,\n  degree = degree(g),\n  betweenness = betweenness(g),\n  closeness = closeness(g)\n) %>%\n  arrange(desc(degree))\n\ncat(\"Top 10 citations by degree centrality:\\n\")\nprint(head(metrics, 10))\n\n# Identify communities\ncommunities <- cluster_louvain(g)\ncat(\"\\nNumber of communities:\", length(communities), \"\\n\")\n```\n:::\n\n\n### Temporal Network Analysis\n\nIf years are available:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add year information to network\ncitation_years <- analysis$citation_references_mapping %>%\n  select(citation_text_clean, cite_year) %>%\n  distinct()\n\nnetwork_with_years <- analysis$network_data %>%\n  left_join(citation_years, by = c(\"citation_from\" = \"citation_text_clean\")) %>%\n  rename(year_from = cite_year) %>%\n  left_join(citation_years, by = c(\"citation_to\" = \"citation_text_clean\")) %>%\n  rename(year_to = cite_year)\n\n# Analyze co-citation patterns by year\nyear_patterns <- network_with_years %>%\n  filter(!is.na(year_from), !is.na(year_to)) %>%\n  mutate(year_diff = abs(year_from - year_to)) %>%\n  group_by(year_diff) %>%\n  summarise(\n    n_pairs = n(),\n    avg_distance = mean(distance)\n  )\n\ncat(\"Co-citation patterns by year difference:\\n\")\nprint(year_patterns)\n```\n:::\n\n\n## Export Network Data\n\n### Save Network Information\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create export directory\ndir.create(\"network_analysis\", showWarnings = FALSE)\n\n# 1. Network statistics\nstats <- attr(network, \"stats\")\nwrite.csv(stats$section_distribution,\n          \"network_analysis/section_distribution.csv\",\n          row.names = FALSE)\n\nif (nrow(stats$multi_section_citations) > 0) {\n  write.csv(stats$multi_section_citations,\n            \"network_analysis/multi_section_citations.csv\",\n            row.names = FALSE)\n}\n\n# 2. Edge list\nwrite.csv(analysis$network_data,\n          \"network_analysis/edge_list.csv\",\n          row.names = FALSE)\n\n# 3. Network summary\nsummary_data <- data.frame(\n  metric = c(\"nodes\", \"edges\", \"density\", \"avg_distance\", \"max_distance\"),\n  value = c(\n    stats$n_nodes,\n    stats$n_edges,\n    stats$n_edges / (stats$n_nodes * (stats$n_nodes - 1) / 2),\n    stats$avg_distance,\n    stats$max_distance\n  )\n)\n\nwrite.csv(summary_data,\n          \"network_analysis/network_summary.csv\",\n          row.names = FALSE)\n```\n:::\n\n\n### Save Interactive Network\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Save as HTML\nlibrary(htmlwidgets)\n\nsaveWidget(network, \n           \"network_analysis/citation_network.html\",\n           selfcontained = TRUE)\n\ncat(\"Network saved to: network_analysis/citation_network.html\\n\")\n```\n:::\n\n\n## Use Cases\n\n### Use Case 1: Literature Review\n\nIdentify citation patterns in review papers:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# High connectivity expected\nnetwork <- create_citation_network(\n  analysis,\n  max_distance = 1000,  # Broader connections\n  min_connections = 3\n)\n\nstats <- attr(network, \"stats\")\n\n# Check network properties\ncat(\"Network density:\", \n    round(stats$n_edges / (stats$n_nodes * (stats$n_nodes - 1) / 2), 3),\n    \"\\n\")\n\n# Hub citations (synthesis points)\nhubs <- stats$section_distribution %>%\n  filter(n >= quantile(n, 0.75))\n\ncat(\"\\nHub citations (potential synthesis points):\\n\")\nprint(hubs)\n```\n:::\n\n\n### Use Case 2: Methods Paper\n\nFocus on methodological citations:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter to Methods section\nmethods_citations <- analysis$citations %>%\n  filter(section == \"Methods\") %>%\n  pull(citation_text_clean)\n\n# Create network subset\nmethods_network_data <- analysis$network_data %>%\n  filter(citation_from %in% methods_citations | \n         citation_to %in% methods_citations)\n\ncat(\"Methods citations:\", length(methods_citations), \"\\n\")\ncat(\"Methods citation pairs:\", nrow(methods_network_data), \"\\n\")\n```\n:::\n\n\n### Use Case 3: Comparative Analysis\n\nCompare citation networks across studies:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Process multiple papers\npapers_info <- data.frame(\n  file = c(\"review.pdf\", \"empirical.pdf\", \"methods.pdf\"),\n  type = c(\"review\", \"empirical\", \"methods\")\n)\n\nnetwork_comparison <- data.frame()\n\nfor (i in 1:nrow(papers_info)) {\n  doc <- pdf2txt_auto(papers_info$file[i], n_columns = 2)\n  analysis <- analyze_scientific_content(doc, mailto = \"your@email.com\")\n  net <- create_citation_network(analysis)\n  stats <- attr(net, \"stats\")\n  \n  network_comparison <- rbind(network_comparison, data.frame(\n    paper = papers_info$file[i],\n    type = papers_info$type[i],\n    nodes = stats$n_nodes,\n    edges = stats$n_edges,\n    density = stats$n_edges / (stats$n_nodes * (stats$n_nodes - 1) / 2),\n    avg_distance = stats$avg_distance\n  ))\n}\n\nprint(network_comparison)\n\n# Visualize comparison\nlibrary(ggplot2)\nggplot(network_comparison, aes(x = type, y = density, fill = type)) +\n  geom_col() +\n  labs(title = \"Network Density by Paper Type\",\n       x = \"Paper Type\", y = \"Network Density\") +\n  theme_minimal()\n```\n:::\n\n\n## Tips and Best Practices\n\n::: {.callout-tip}\n## Choosing Parameters\n\n**max_distance**:\n- 200-400: Very close citations (same paragraph)\n- 500-800: Moderate proximity (recommended)\n- 1000+: Broader connections (same section)\n\n**min_connections**:\n- 1: Include all connected citations\n- 2-3: Filter isolated pairs (recommended)\n- 5+: Focus on hub citations only\n:::\n\n::: {.callout-tip}\n## Interpretation\n\nLook for:\n- **Clusters**: Groups of related citations\n- **Hubs**: Frequently co-cited works\n- **Bridges**: Citations connecting different clusters\n- **Isolates**: Citations rarely co-cited\n:::\n\n::: {.callout-note}\n## Performance\n\nFor large documents:\n- Start with higher `min_connections`\n- Use moderate `max_distance`\n- Consider section-specific networks\n- Save network as HTML for sharing\n:::\n\n## See Also\n\n- [Citation Analysis](citation-analysis.qmd): Extract and analyze citations\n- [Content Analysis](content-analysis.qmd): Main analysis function\n- [Tutorial](../tutorial.qmd): Complete workflow examples",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}